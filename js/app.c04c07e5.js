(function(){"use strict";var t={6967:function(t,e,s){var n,r=s(5471),a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"app-wrapper"},[e("div",{staticClass:"app-header"},[e("h1",[t._v("Horse Racing")]),e("race-controls")],1),e("div",{staticClass:"main-content"},[e("aside",{staticClass:"sidebar-left"},[e("horse-list")],1),e("main",{staticClass:"center-area"},[e("race-track")],1),e("aside",{staticClass:"sidebar-right"},[e("results-panel")],1)])])},o=[],i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"controls"},[e("button",{staticClass:"button",on:{click:t.generateGame}},[t._v(" Generate Game ")]),e("button",{staticClass:"button",attrs:{disabled:!t.isReady},on:{click:t.startRace}},[t._v(" Start Race ")])])},u=[];function c(){var t=(0,r.nI)();if(!t)throw new Error("useStore must be called inside setup()");return t.proxy.$store}(function(t){t["IDLE"]="idle",t["READY"]="ready",t["RUNNING"]="running",t["FINISHED"]="finished"})(n||(n={}));var l=(0,r.pM)({name:"RaceControls",setup(){const t=c(),e=(0,r.EW)(()=>t.state.status===n.READY),s=()=>{t.dispatch("generateGame")},a=()=>{t.dispatch("startRace")};return{isReady:e,generateGame:s,startRace:a}}}),d=l,f=s(1656),v=(0,f.A)(d,i,u,!1,null,"71539158",null),h=v.exports,p=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"race-track"},[t.currentRound?e("div",{staticClass:"track-container"},[e("h2",[t._v("Round "+t._s(t.currentRound.id)+" - "+t._s(t.currentRound.distance)+"m")]),e("div",{staticClass:"track-wrapper"},[e("div",{staticClass:"lane-numbers"},t._l(t.currentRound.horseIds,function(s,n){return e("div",{key:`num-${s}`,staticClass:"lane-number"},[t._v(" "+t._s(n+1)+" ")])}),0),e("div",{staticClass:"lanes"},[t._l(t.currentRound.horseIds,function(s){return e("div",{key:s,staticClass:"lane"},[e("div",{staticClass:"lane-name"},[t._v(t._s(t.getHorseName(s)))]),e("div",{staticClass:"lane-track"},[e("div",{staticClass:"horse",style:{...t.getHorseStyle(s),backgroundColor:t.getHorseColor(s)}}),t.getHorsePosition(s)?e("div",{staticClass:"position-badge"},[t._v(t._s(t.getHorsePosition(s)))]):t._e()])])}),e("div",{staticClass:"finish-label"},[t._v("FINISH")])],2)])]):e("div",{staticClass:"no-race"},[t.status===t.RunStatus.IDLE?e("p",[t._v('Click "Generate Game" to create new game')]):t.status===t.RunStatus.READY?e("div",{staticClass:"game-info"},[e("p",{staticClass:"info-title"},[t._v("Game generated!")]),e("p",[t._v("Horses: "+t._s(t.horsesCount))]),e("p",[t._v("Rounds: "+t._s(t.roundsCount))]),e("p",{staticClass:"info-subtitle"},[t._v('Click "Start Race" to start a competition')])]):t.status===t.RunStatus.FINISHED?e("div",{staticClass:"winner-section"},[e("p",{staticClass:"winner-title"},[t._v("ðŸ† Winner:")]),e("p",{staticClass:"winner-name"},[t._v(t._s(t.getWinnerName))]),e("p",{staticClass:"winner-subtitle"},[t._v("Full results are on the right >")])]):t._e()])])},_=[],m=(s(4114),s(8111),s(116),s(7588),s(1701),(0,r.pM)({name:"RaceTrack",setup(){const t=c(),e=(0,r.KR)(new Map),s=(0,r.KR)(new Map),a=(0,r.EW)(()=>t.getters.currentRound),o=(0,r.EW)(()=>t.state.status),i=(0,r.EW)(()=>t.state.results),u=(0,r.EW)(()=>t.state.horses.length),l=(0,r.EW)(()=>t.state.rounds.length),d=e=>{const s=t.getters.getHorseById(e);return s?s.name:""},f=(0,r.EW)(()=>{const t=i.value;if(0===t.length)return"";const e=new Map;t.forEach(t=>{t.standings.forEach((t,s)=>{const n=10-s,r=e.get(t.horseId)||0;e.set(t.horseId,r+n)})});let s=0,n=0;return e.forEach((t,e)=>{t>n&&(n=t,s=e)}),d(s)}),v=e=>{const s=t.getters.getHorseById(e);return s?s.color:"#000"},h=t=>{const e=a.value;if(!e)return 0;const s=i.value.find(t=>t.roundId===e.id);if(!s)return 0;const n=s.standings.find(e=>e.horseId===t);return n?n.timeMs:0},p=t=>{const s=h(t),n=e.value.get(t),r=s>0&&n?1:0;return{left:95*r+"%",transition:s>0?`left ${s}ms linear`:"none"}},_=t=>{if(!s.value.get(t))return null;const e=a.value;if(!e)return null;const n=i.value.find(t=>t.roundId===e.id);if(!n)return null;const r=n.standings.findIndex(e=>e.horseId===t);return-1===r?null:r+1};return(0,r.wB)([a,i],([t,n],r,a)=>{if(!t)return e.value=new Map,void(s.value=new Map);const o=n.find(e=>e.roundId===t.id);if(!o)return e.value=new Map,void(s.value=new Map);let i,u;e.value=new Map,s.value=new Map;const c=[];i=setTimeout(()=>{u=setTimeout(()=>{e.value=new Map(t.horseIds.map(t=>[t,!0])),t.horseIds.forEach(t=>{const e=o.standings.find(e=>e.horseId===t);if(e&&e.timeMs>0){const n=setTimeout(()=>{s.value.set(t,!0),s.value=new Map(s.value)},e.timeMs);c.push(n)}})},100)},0),a(()=>{clearTimeout(i),clearTimeout(u),c.forEach(clearTimeout)})}),{currentRound:a,status:o,horsesCount:u,roundsCount:l,getHorseName:d,getHorseColor:v,getHorseStyle:p,getHorsePosition:_,getWinnerName:f,RunStatus:n}}})),g=m,C=(0,f.A)(g,p,_,!1,null,"c26bf930",null),b=C.exports,y=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"results-panel"},[e("div",{staticClass:"tabs"},[e("button",{class:["tab",{active:"program"===t.activeTab}],on:{click:function(e){t.activeTab="program"}}},[t._v(" Program ")]),e("button",{class:["tab",{active:"results"===t.activeTab}],on:{click:function(e){t.activeTab="results"}}},[t._v(" Results ")])]),e("div",{staticClass:"tab-content"},["program"===t.activeTab?e("div",{staticClass:"program-section"},[0===t.rounds.length?e("div",{staticClass:"empty-state"},[t._v(" No program generated yet ")]):e("div",{staticClass:"rounds-list"},t._l(t.rounds,function(s){return e("div",{key:s.id,staticClass:"round-program"},[e("div",{staticClass:"round-header"},[t._v(" Round "+t._s(s.id)+" - "+t._s(s.distance)+"m ")]),e("table",{staticClass:"program-table"},[t._m(0,!0),e("tbody",t._l(s.horseIds,function(s,n){return e("tr",{key:s},[e("td",[t._v(t._s(n+1))]),e("td",[t._v(t._s(t.getHorseName(s)))])])}),0)])])}),0)]):t._e(),"results"===t.activeTab?e("div",{staticClass:"results-section"},[0===t.results.length?e("div",{staticClass:"empty-state"},[t._v(" No results yet ")]):e("div",{staticClass:"results-list"},t._l(t.results,function(s){return e("div",{key:s.roundId,staticClass:"round-result"},[e("div",{staticClass:"round-title"},[t._v(" Round "+t._s(s.roundId)+" â€” "+t._s(s.distance)+"m ")]),e("table",{staticClass:"results-table"},[t._m(1,!0),e("tbody",t._l(s.standings,function(s,n){return e("tr",{key:s.horseId},[e("td",[t._v(t._s(n+1))]),e("td",[t._v(t._s(t.getHorseName(s.horseId)))]),e("td",[t._v(t._s((s.timeMs/1e3).toFixed(2))+"s")])])}),0)])])}),0)]):t._e()])])},R=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("thead",[e("tr",[e("th",[t._v("Position")]),e("th",[t._v("Name")])])])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("thead",[e("tr",[e("th",[t._v("Position")]),e("th",[t._v("Horse")]),e("th",[t._v("Time (s)")])])])}],I=(0,r.pM)({name:"ResultsPanel",setup(){const t=c(),e=(0,r.KR)("program"),s=(0,r.EW)(()=>t.state.rounds),n=(0,r.EW)(()=>t.state.results),a=e=>{const s=t.getters.getHorseById(e);return s?s.name:""};return{activeTab:e,rounds:s,results:n,getHorseName:a}}}),w=I,E=(0,f.A)(w,y,R,!1,null,"3d670f52",null),x=E.exports,k=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"horse-list"},[e("h3",{staticClass:"title"},[t._v("Horse List (1-20)")]),t.horses.length?e("table",{staticClass:"horses-table"},[t._m(0),e("tbody",t._l(t.horses,function(s){return e("tr",{key:s.id},[e("td",[t._v(t._s(s.name))]),e("td",[t._v(t._s(s.condition))]),e("td",[e("div",{staticClass:"color-box",style:{backgroundColor:s.color}})])])}),0)]):e("div",{staticClass:"no-horse-list"},[t._v("No horses list yet")])])},M=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("thead",[e("tr",[e("th",[t._v("Name")]),e("th",[t._v("Condition")]),e("th",[t._v("Color")])])])}],H=(0,r.pM)({name:"HorseList",setup(){const t=c(),e=(0,r.EW)(()=>t.state.horses);return{horses:e}}}),A=H,N=(0,f.A)(A,k,M,!1,null,"136daf8d",null),T=N.exports,P=(0,r.pM)({name:"App",components:{RaceControls:h,RaceTrack:b,ResultsPanel:x,HorseList:T}}),S=P,F=(0,f.A)(S,a,o,!1,null,"7336decb",null),D=F.exports,O=s(5353);function W(t,e){return Math.floor(Math.random()*(e-t+1))+t}var G=function(t,e,s,n){function r(t){return t instanceof s?t:new s(function(e){e(t)})}return new(s||(s=Promise))(function(s,a){function o(t){try{u(n.next(t))}catch(e){a(e)}}function i(t){try{u(n["throw"](t))}catch(e){a(e)}}function u(t){t.done?s(t.value):r(t.value).then(o,i)}u((n=n.apply(t,e||[])).next())})},B=function(t,e){var s,n,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return o.next=i(0),o["throw"]=i(1),o["return"]=i(2),"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(t){return function(e){return u([t,e])}}function u(i){if(s)throw new TypeError("Generator is already executing.");while(o&&(o=0,i[0]&&(a=0)),a)try{if(s=1,n&&(r=2&i[0]?n["return"]:i[0]?n["throw"]||((r=n["return"])&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],n=0}finally{s=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};r.Ay.use(O.Ay);var j=10,L=new O.Ay.Store({state:{horses:[],rounds:[],results:[],currentRoundIndex:-1,status:n.IDLE},mutations:{setHorses:function(t,e){t.horses=e},setRounds:function(t,e){t.rounds=e},pushResult:function(t,e){t.results.push(e)},setStatus:function(t,e){t.status=e},setCurrentRoundIndex:function(t,e){t.currentRoundIndex=e},reset:function(t){t.horses=[],t.rounds=[],t.results=[],t.currentRoundIndex=-1,t.status=n.IDLE}},actions:{generateGame:function(t){var e=t.commit,s=W(10,20),r=Y(s),a=$(s);e("reset"),e("setHorses",r),e("setRounds",a),e("setStatus",n.READY),e("setCurrentRoundIndex",-1)},startRace:function(t){return G(this,arguments,void 0,function(t){var e,s=t.state,r=t.commit,a=t.dispatch;return B(this,function(t){switch(t.label){case 0:if(s.status!==n.READY)return[2];r("setStatus",n.RUNNING),e=0,t.label=1;case 1:return e<s.rounds.length?(r("setCurrentRoundIndex",e),[4,a("runRound",s.rounds[e])]):[3,5];case 2:return t.sent(),[4,new Promise(function(t){return setTimeout(t,600)})];case 3:t.sent(),t.label=4;case 4:return e++,[3,1];case 5:return r("setStatus",n.FINISHED),r("setCurrentRoundIndex",-1),[2]}})})},runRound:function(t,e){return G(this,arguments,void 0,function(t,e){var s,n,r,a,o,i,u,c,l=t.state,d=t.commit;return B(this,function(t){switch(t.label){case 0:for(s=[],n=function(t){var n=l.horses.find(function(e){return e.id===t});if(!n)return console.error("Horse with id ".concat(t," not found")),"continue";var r=2*e.distance,a=.6+n.condition/100,o=300*Math.random()-150,i=Math.round(r/a+o),u=Math.max(800,i);s.push({horseId:t,timeMs:u})},r=0,a=e.horseIds;r<a.length;r++)o=a[r],n(o);return s.sort(function(t,e){return t.timeMs-e.timeMs}),i={roundId:e.id,distance:e.distance,standings:s},d("pushResult",i),u=Math.max.apply(Math,s.map(function(t){return t.timeMs})),c=200,[4,new Promise(function(t){return setTimeout(t,u+c)})];case 1:return t.sent(),[2]}})})}},getters:{getHorseById:function(t){return function(e){return t.horses.find(function(t){return t.id===e})}},currentRound:function(t){return t.currentRoundIndex<0?null:t.rounds[t.currentRoundIndex]}}});function Y(t){void 0===t&&(t=20);for(var e=["#EF798A","#F7A9A8","#613F75","#E5C3D1","#988B8E","#ECC8AF","#E7AD99","#CE796B","#C18C5D","#495867","#0A0908","#22333B","#F2F4F3","#A9927D","#5E503F","#7209B7","#F72585","#4361EE","#06FFA5","#FFB703"],s=[],n=0;n<t;n++)s.push({id:n+1,name:"Horse ".concat(n+1),color:e[n],condition:W(1,100)});return s}function $(t){var e=[1200,1400,1600,1800,2e3,2200];return e.map(function(e,s){var n=new Set;while(n.size<j)n.add(W(1,t));return{id:s+1,distance:e,horseIds:Array.from(n)}})}r.Ay.config.productionTip=!1,new r.Ay({store:L,render:t=>t(D)}).$mount("#app")}},e={};function s(n){var r=e[n];if(void 0!==r)return r.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,s),a.exports}s.m=t,function(){var t=[];s.O=function(e,n,r,a){if(!n){var o=1/0;for(l=0;l<t.length;l++){n=t[l][0],r=t[l][1],a=t[l][2];for(var i=!0,u=0;u<n.length;u++)(!1&a||o>=a)&&Object.keys(s.O).every(function(t){return s.O[t](n[u])})?n.splice(u--,1):(i=!1,a<o&&(o=a));if(i){t.splice(l--,1);var c=r();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[n,r,a]}}(),function(){s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,a,o=n[0],i=n[1],u=n[2],c=0;if(o.some(function(e){return 0!==t[e]})){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(u)var l=u(s)}for(e&&e(n);c<o.length;c++)a=o[c],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return s.O(l)},n=self["webpackChunkhorse_racing_game"]=self["webpackChunkhorse_racing_game"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],function(){return s(6967)});n=s.O(n)})();
//# sourceMappingURL=app.c04c07e5.js.map